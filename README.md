🎨 Anima WebUI <small>v1.5.2</small>

Anima WebUI は、ComfyUI をバックエンドとして利用し、直感的な操作で高品質な画像生成を行うための Gradio ベースの Web UI です。 v1.5.0 では、プロンプト入力時の**「アンダースコア自動置換機能」**を追加し、Danbooruタグの入力がよりスムーズになりました。
🎯 想定するユーザ層

    ComfyUI を既に導入済み、あるいは自力でインストールできる方

    必要なモデルを自身でダウンロードし、所定のフォルダへ配置できる方

    技術的な前提条件を理解し、環境構築の「罠」を自力で回避できる知性をお持ちの方

🛠 事前準備

    ソフトウェア環境

        Python 3.12.x: インストール時に必ず [Add Python to PATH] にチェックを入れてください。

        ComfyUI: 画像生成のバックエンドとして動作している必要があります。

    モデル & ワークフローの導入

        必要なモデルは https://huggingface.co/circlestone-labs/Anima からダウンロードできます。
        anima-t2i.json を ComfyUI ブラウザ画面に D&D し、ワークフローのモデル読み込み部分に書いてある通りのフォルダ位置にモデルを配置し、ComfyUI で画像が生成できることを確認してください。

🚀 セットアップと起動手順

    リポジトリの準備
    PowerShell

    git clone https://github.com/okpn/anima-webui.git
    cd anima-webui

    設定ファイルの準備

        config.json.sample をコピーして config.json を作成するか、アプリ内の System タブから直接設定を行ってください。

    起動

        start_anima_webui.bat を実行します。
        コンソールを見て起動を確認したら、 localhost:7861 にアクセスしてください。
        起動後、Systemタブに移動し、ComfyUI Output Path (Absolute Path)にお使いのComfyUIのoutputフォルダの絶対パスをコピーして設定を保存してください。これで最低限の生成環境が整います。
    

💡 主な機能 (v1.4.0)
タブ名	機能概要
Generate	

プロンプト強調: Positive/Negative プロンプト入力欄に `+` `-` ボタンを追加。`(text:1.1)` 形式の重みをワンクリックで調整可能。

Custom Tags (My Palette): 独自のタグセットを管理し、ワンタップで追加可能。

年代スロット: 最大 3 つの年代を混合指定（1950-2026）できるブレンディング機能。

翻訳アコーディオン: 垂直スペースを削減した DeepL プロンプト・ブリッジ。
History	

WebPサムネイル: オリジナル画像の代わりに軽量なサムネイルを表示し、VRAM/RAM消費を最小限に抑えます。

バックグラウンド生成: 過去の膨大な画像履歴も、アプリ起動中に裏側で自動的にサムネイル化（UIをブロックしません）。

手動リフレッシュ: タブ切り替え時の自動読み込みを廃止し、任意のタイミングで更新できる「Refresh」ボタンを設置。

HSM 2.0 (階層型ストレージ管理): 画像を外部（Nextcloud等）へ移動したり、.jxl 等に変換しても自動で追跡・表示。

セキュア削除: 二段階確認 ＋ タイムスタンプ付き自動バックアップにより、誤消去を防止。

手動バックアップ: 履歴を維持したまま、現在の状態を .bak ファイルとして保存可能。
System	

バックアップ・トラッキング: 退避先フォルダを指定し、Gradio のセキュリティ制限を自動回避。

IP 自動検出: PC のローカル IP を検出し、外部デバイスからのアクセス設定を容易にします。
⚠️ 注意事項

    動的パス解決: ComfyUI の output フォルダを整理するために画像を移動しても、ファイル名さえ維持されていれば本アプリは画像を追跡し続けます。

    JXL 表示について: ブラウザが JPEG XL をサポートしていない場合、パスが解決できても画像が表示されない（壊れたアイコンになる）場合があります。

    削除の安全弁: 「Clear History」を実行すると、元の history.json は削除直前に日付入りの .bak ファイルとして複製保存されます。

📈 Version History
    v1.5.2 : 軽微な修正。

    v1.5.1 : 履歴のお気に入り機能を追加。軽微な修正。

    v1.5.0 : プロンプト内のアンダースコア `_` を自動的にスペースに置換する機能を追加（`score_` タグを除く）。オートコンプリート機能の強化。

    v1.4.1 : プロンプトの強調ボタンを追加。UIレイアウトの微調整。

    v1.4.0 : WebPサムネイル機能の実装によるギャラリー表示の高速化・省メモリ化。バックグラウンド生成処理の追加。

    v1.3.2 : プログラム構造を最適化。

    v1.3.1 : JPEG XL (.jxl) 等のフォーマット変更に対応する拡張子冗長検索機能を搭載。

    v1.3.0: 階層型ストレージ管理 (HSM) の本格実装。履歴消去時の世代管理バックアップ機能。

    v1.2.x: Custom Tags、DeepL 連携、年代ブレンディング、IP 自動検出機能の実装。

📜 License

本アプリは Polyform Noncommercial License 1.0.0 を採用しています。個人利用・研究目的は自由ですが、本プログラムそのものの販売は禁止されています。
生成物の権利については開発者は何も主張しませんが、生成物の商用利用可否については利用モデルの規約にしたがってください。
