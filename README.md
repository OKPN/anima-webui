🎨 Anima WebUI <small>v1.3.0</small>

Anima WebUI は、ComfyUI をバックエンドとして利用し、直感的な操作で高品質な画像生成を行うための Gradio ベースの Web UI です。 v1.3.0 では、プロフェッショナルな「階層型ストレージ管理」と、データの安全性を極限まで高めた履歴システムを搭載しました。

🎯 想定するユーザ層

    ComfyUI を既に導入済み、あるいは自力でインストールできる方
    必要なモデルを自身でダウンロードし、所定のフォルダへ配置できる方
    技術的な前提条件を理解し、環境構築の「罠」を自力で回避できる知性をお持ちの方

🛠 事前準備

1. ソフトウェア環境
    Python 3.12.x: インストール時に必ず [Add Python to PATH] にチェックを入れてください。
    ComfyUI: 画像生成のバックエンドとして動作している必要があります。

2. モデル & ワークフローの導入
    Hugging Face 等から以下のファイルを配置してください。
    モデルファイル: models/checkpoints/ フォルダへ配置。
    ワークフローファイル: anima-t2i.json を本アプリのルートフォルダに配置。

🚀 セットアップと起動手順

    リポジトリの準備
    PowerShell
    git clone https://github.com/okpn/anima-webui.git
    cd anima-webui

    設定ファイルの準備
        config.json.sample をコピーして config.json を作成、またはアプリ内の System タブから設定を行ってください。

    起動
        start_anima_webui.bat を実行します。

💡 主な機能 (v1.3.0)

| タブ名 | 機能概要 |
| :--- | :--- |
| **Generate** | **Custom Tags (My Palette)**: ユーザー独自のタグセットをワンタップで追加可能。<br>**翻訳アコーディオン**: 垂直スペースを削減した DeepL プロンプト・ブリッジ。<br>**年代スロット**: 最大 3 つの年代を混合指定できるブレンディング機能。 |
| **History** | **プロフェッショナル・プレビュー**: 画像クリックで即時復元せず、内容を確認してから復元する安全設計。<br>**動的パス解決 (HSM)**: 画像を Nextcloud 等のバックアップ先に移動した後も、自動で追跡して表示を継続。<br>**セキュア削除**: 二段階確認 + タイムスタンプ付き自動バックアップにより、誤消去によるデータ消失を防止。<br>**手動バックアップ**: 履歴を消さずに現在の状態を別ファイルとして保存可能。 |
| **System** | **バックアップ・トラッキング**: 退避先フォルダを指定し、Gradio のセキュリティ制限を自動で回避。<br>**タグ・エディタ**: 全カテゴリのタグリストを UI 上で直接編集・保存可能。<br>**IP 自動検出**: サーバーのローカル IP を検出し、外部デバイスからのアクセスを容易にします。 |

⚠️ 注意事項

    階層型ストレージ運用: ComfyUI の output フォルダを整理するために画像を外部（Nextcloud等）へ移動しても、ファイル名さえ維持されていれば本アプリは履歴から画像を追いかけ続けます。
    削除の安全弁: 「Clear History」を実行すると、元の `history.json` は削除される直前に日付入りの `.bak` ファイルとして複製されます。
    Gradio セキュリティ: バックアップフォルダの画像を表示するため、`app.py` 側で `allowed_paths` の自動設定を行っています。

📈 Version History

    v1.3.0 (最新): 階層型ストレージ管理（動的フォールバック参照）搭載。履歴のプレビュー/復元分離ワークフロー。タイムスタンプ付き世代管理バックアップ機能。 システムレイアウトの最適化。バックアップパス設定の統合。
    v1.2.3: Custom Tags (My Palette) 搭載。 履歴復元パラメータを 22 種に拡張。
    v1.2.2: DeepL 翻訳セクションのアコーディオン化。UI の垂直スペース削減。
    v1.2.0: 年代混合スロット（1950-2026）、IP 自動検出機能、履歴機能の大幅強化。

📜 License

本アプリは Polyform Noncommercial License 1.0.0 を採用しています。個人利用・研究目的は自由ですが、商用販売は禁止です。